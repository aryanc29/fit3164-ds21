<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>NSW weather data visualisation dashboard</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
    <!-- Project CSS -->
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <!-- Accessibility CSS -->
    <link rel="stylesheet" href="/static/css/a11y.css">
</head>
<body>
    <!-- Skip link -->
    <a href="#main" class="skip-link">Skip to main content</a>

    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="fas fa-cloud-sun"></i> NSW Weather Data Dashboard</a>
        </div>
    </nav>

    <!-- Main landmark -->
    <main id="main" class="container mt-4" role="main" aria-labelledby="page-heading">
        <h1 id="page-heading" class="visually-hidden">NSW weather data visualisation</h1>

        <!-- Accessibility controls -->
        <section class="container mb-4" role="region" aria-labelledby="a11y-heading">
            <h2 id="a11y-heading" class="visually-hidden">Accessibility controls</h2>
            <div class="card p-3">
                <div class="row g-2 align-items-center">
                    <div class="col-md-3">
                        <label for="colour-scale" class="form-label">Colour scale</label>
                        <select id="colour-scale" class="form-select" aria-label="Select colour scale">
                            <option>Viridis</option>
                            <option>Cividis</option>
                            <option>Plasma</option>
                            <option>Inferno</option>
                            <option>Magma</option>
                            <option>Turbo</option>
                        </select>
                    </div>
                    <div class="col-md-3 form-check mt-3">
                        <input class="form-check-input" type="checkbox" id="dark-contrast" aria-label="Enable high-contrast dark mode">
                        <label class="form-check-label" for="dark-contrast">High-contrast dark</label>
                    </div>
                    <div class="col-md-3 form-check mt-3">
                        <input class="form-check-input" type="checkbox" id="reduced-motion" aria-label="Prefer reduced motion" checked>
                        <label class="form-check-label" for="reduced-motion">Reduced motion</label>
                    </div>
                    <div class="col-md-3 mt-3">
                        <label for="font-size" class="form-label">Font size</label>
                        <input type="range" id="font-size" class="form-range" min="14" max="24" value="18" aria-label="Adjust font size">
                    </div>
                    <div class="col-12 d-flex align-items-center gap-2 mt-2">
                        <button id="speak-summary" class="btn btn-primary" aria-label="Speak the current summary">Speak summary</button>
                        <span id="tts-status" role="status" aria-live="polite" class="small">Audio status: ready</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Search Section -->
        <div id="searchSection" class="mb-4">
            <div class="card p-3">
                <div class="row gx-2 align-items-center">
                    <div class="col-md-10">
                        <input id="topPlaceSearchInput" class="form-control form-control-lg" placeholder="Search location (OpenStreetMap)" autocomplete="off" aria-label="Location search">
                        <div id="topPlaceSearchResults" class="list-group custom-results"></div>
                    </div>
                    <div class="col-md-2 text-end">
                        <button id="topSearchClear" class="btn btn-light">Clear</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Results Container -->
        <div id="searchResultsContainer" class="mb-4 search-results-hidden">
            <div class="card">
                <div class="card-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fas fa-map-marker-alt"></i> <span id="selectedLocationName">Location details</span></h5>
                        <button id="closeResults" class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="searchResultsContent">
                        <!-- Results will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Overview Section -->
        <section id="overview" class="mb-5">
            <h2><i class="fas fa-chart-line"></i> Dataset overview</h2>
            <div class="row" id="statsCards">
                <div class="col-md-3">
                    <div class="card stats-card">
                        <div class="stats-number" id="totalRecords">...</div>
                        <div class="stats-label">Total records</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stats-card">
                        <div class="stats-number" id="totalStations">...</div>
                        <div class="stats-label">Weather stations</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stats-card">
                        <div class="stats-number" id="avgET">...</div>
                        <div class="stats-label">Avg ET</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stats-card">
                        <div class="stats-number" id="avgTemp">...</div>
                        <div class="stats-label">Avg temp</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Map Section -->
        <section id="map" class="mb-5" aria-labelledby="map-heading">
            <h2 id="map-heading"><i class="fas fa-map-marked-alt"></i> Interactive map</h2>
            <div class="map-controls">
                <div class="row gx-2">
                    <div class="col-md-6">
                        <label for="mapMetric" class="form-label visually-hidden">Map metric</label>
                        <select id="mapMetric" class="form-select" aria-label="Map metric selector">
                            <option value="record_count">Record count</option>
                            <option value="avg_rainfall">Avg rainfall</option>
                            <option value="avg_evapotranspiration">Avg ET</option>
                        </select>
                    </div>
                    <div class="col-md-6 text-end">
                        <button id="updateMapBtn" class="btn btn-sm btn-primary">Update map</button>
                    </div>
                </div>
            </div>
            <div id="weatherMap" class="map-container" aria-label="Interactive map of NSW weather stations"></div>

            <!-- Accessible caption -->
            <figure role="group" aria-labelledby="map-caption-heading" class="mt-2">
                <h3 id="map-caption-heading" class="visually-hidden">Map caption</h3>
                <figcaption id="caption" class="caption" aria-live="polite">Loading summary…</figcaption>
            </figure>
        </section>

        <!-- Stations Grid -->
        <section id="stations" class="mb-5">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2><i class="fas fa-server"></i> Stations</h2>
                <button id="toggleStationsBtn" class="btn btn-sm btn-outline-secondary">
                    <i class="fas fa-eye-slash"></i> Hide stations
                </button>
            </div>
            <div id="stationCount" class="mb-2 text-muted">...</div>
            <div id="stationsGrid" class="station-grid"></div>
        </section>

        <!-- Feedback Section -->
        <section id="feedback" class="mb-5">
            <h2><i class="fas fa-comments"></i> Feedback</h2>
            <div class="card p-4">
                <h5>Help us improve. Share your thoughts and suggestions.</h5>
                <form id="feedbackForm">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="feedbackName" class="form-label">Name</label>
                            <input type="text" class="form-control" id="feedbackName" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="feedbackEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="feedbackEmail" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="feedbackType" class="form-label">Feedback type</label>
                        <select class="form-select" id="feedbackType" required>
                            <option value="">Select type…</option>
                            <option value="bug">Report a bug</option>
                            <option value="feature">Feature request</option>
                            <option value="general">General feedback</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="feedbackSubject" class="form-label">Subject</label>
                        <input type="text" class="form-control" id="feedbackSubject" required>
                    </div>
                    <div class="mb-3">
                        <label for="feedbackMessage" class="form-label">Message</label>
                        <textarea class="form-control" id="feedbackMessage" rows="4" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i> Submit feedback
                    </button>
                </form>
                <div id="feedbackStatus" class="mt-3" style="display: none;" role="status" aria-live="polite"></div>
            </div>
        </section>
    </main>

    <!-- External scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Accessibility helpers must load before your app JS -->
    <script src="/static/js/a11y.js"></script>
    <!-- Your app JS -->
    <script src="/static/js/dashboard.js?v=1"></script>
</body>
</html>
