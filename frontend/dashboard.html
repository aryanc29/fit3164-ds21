<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>NSW Weather Data Visualization Dashboard</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="fas fa-cloud-sun"></i> NSW Weather Data Dashboard</a>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Search Section -->
        <div id="searchSection" class="mb-4">
            <div class="card p-3">
                <div class="row gx-2 align-items-center">
                    <div class="col-md-10">
                        <input id="topPlaceSearchInput" class="form-control form-control-lg" placeholder="Search location (OpenStreetMap)" autocomplete="off" aria-label="Location search" />
                        <div id="topPlaceSearchResults" class="list-group custom-results"></div>
                    </div>
                    <div class="col-md-2 text-end">
                        <button id="topSearchClear" class="btn btn-light">Clear</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Results Container -->
        <div id="searchResultsContainer" class="mb-4 search-results-hidden">
            <div class="card">
                <div class="card-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fas fa-map-marker-alt"></i> <span id="selectedLocationName">Location Details</span></h5>
                        <button id="closeResults" class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="searchResultsContent">
                        <!-- Results will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Overview Section -->
        <section id="overview" class="mb-5">
            <h2><i class="fas fa-chart-line"></i> Dataset Overview</h2>
            <div class="row" id="statsCards">
                <div class="col-md-3">
                    <div class="card stats-card">
                        <div class="stats-number" id="totalRecords">...</div>
                        <div class="stats-label">Total Records</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stats-card">
                        <div class="stats-number" id="totalStations">...</div>
                        <div class="stats-label">Weather Stations</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stats-card">
                        <div class="stats-number" id="avgET">...</div>
                        <div class="stats-label">Avg ET</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stats-card">
                        <div class="stats-number" id="avgTemp">...</div>
                        <div class="stats-label">Avg Temp</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Map Section -->
        <section id="map" class="mb-5">
            <h2><i class="fas fa-map-marked-alt"></i> Interactive Map</h2>
            <div class="map-controls">
                <div class="row gx-2">
                    <div class="col-md-6">
                        <label for="mapMetric" class="form-label visually-hidden">Map metric</label>
                        <select id="mapMetric" class="form-select" aria-label="Map metric selector">
                            <option value="record_count">Record Count</option>
                            <option value="avg_rainfall">Avg Rainfall</option>
                            <option value="avg_evapotranspiration">Avg ET</option>
                        </select>
                    </div>
                    <div class="col-md-6 text-end">
                        <button id="updateMapBtn" class="btn btn-sm btn-primary">Update Map</button>
                    </div>
                </div>
            </div>
            <div id="weatherMap" class="map-container"></div>
        </section>

        <!-- Stations Grid -->
        <section id="stations" class="mb-5">
            <h2><i class="fas fa-server"></i> Stations</h2>
            <div id="stationCount" class="mb-2 text-muted">...</div>
            <div id="stationsGrid" class="station-grid"></div>
        </section>

    </div>

    <!-- External scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="/static/js/dashboard.js"></script>
</body>
</html>
